!function(){function t(t){return t&&t.__esModule?t.default:t}var e={};var n=function(t){var n=e[t];if(null==n)throw new Error("Could not resolve bundle with id "+t);return n};(function(t){for(var n=Object.keys(t),o=0;o<n.length;o++)e[n[o]]=t[n[o]]})(JSON.parse('{"3PAIj":"index.c0395e55.js","5ILLM":"ball_8.6a0ed354.png","1bPlU":"ball_16.7dc94788.png","3Is0U":"table.a17d2cdc.png"}'));class o{constructor(t=0,e=0){this.x=t,this.y=e}static distance(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}distance(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}static distanceSq(t,e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)}magnitude(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}normalize(){let t=this.magnitude();return this.x/=t,this.y/=t,this}static add(t,e){return new o(t.x+e.x,t.y+e.y)}add(t){this.x+=t.x,this.y+=t.y}static subtract(t,e){return new o(t.x-e.x,t.y-e.y)}subtract(t){return new o(this.x-t.x,this.y-t.y)}static divide(t,e){return new o(t.x/e.x,t.y/e.y)}static multiply(t,e){return new o(t.x*e.x,t.y*e.y)}multiply(t){return new o(this.x*t.x,this.y*t.y)}static scale(t,e){return new o(t.x*e,t.y*e)}scale(t){return new o(this.x*t,this.y*t)}static dot(t,e){return t.x*e.x+t.y*e.y}dot(t){return this.x*t.x+this.y*t.y}}var s=null;var i,r=function(){return s||(s=function(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return(""+t[0]).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}()),s},a=n;function c(t){if(""===t)return".";var e="/"===t[t.length-1]?t.slice(0,t.length-1):t,n=e.lastIndexOf("/");return-1===n?".":e.slice(0,n)}function l(t,e){if(t===e)return"";var n=t.split("/");"."===n[0]&&n.shift();var o,s,i=e.split("/");for("."===i[0]&&i.shift(),o=0;(o<i.length||o<n.length)&&null==s;o++)n[o]!==i[o]&&(s=o);var r=[];for(o=0;o<n.length-s;o++)r.push("..");return i.length>s&&r.push.apply(r,i.slice(s)),r.join("/")}(i=function(t,e){return l(c(a(t)),a(e))})._dirname=c,i._relative=l;var u=t(r()+i("3PAIj","5ILLM")),d=t(r()+i("3PAIj","1bPlU")),y=t(r()+i("3PAIj","3Is0U"));function p(t,e,n,o,s,i,r){const a=h(t,e,s,i,r),c=h(n,o,s,i,r);if(a||c)return!0;let l=t-n,u=e-o;const d=Math.sqrt(l*l+u*u),y=((s-t)*(n-t)+(i-e)*(o-e))/Math.pow(d,2),p=t+y*(n-t),f=e+y*(o-e);if(!function(t,e,n,o,s,i){const r=x(s,i,t,e),a=x(s,i,n,o),c=x(t,e,n,o),l=.1;if(r+a>=c-l&&r+a<=c+l)return!0;return!1}(t,e,n,o,p,f))return!1;l=p-s,u=f-i;return Math.sqrt(l*l+u*u)<=r}function h(t,e,n,o,s){const i=t-n,r=e-o;return Math.sqrt(i*i+r*r)<=s}function x(t,e,n,o){return Math.sqrt((t-n)*(t-n)+(e-o)*(e-o))}const f=document.createElement("canvas"),w=f.getContext("2d"),v=1030,g=590,b=14;if(f.width=v,f.height=g,document.body.appendChild(f),f.style.width="515px",f.style.height="295px",!w)throw new Error("can't init 2d renderer");const m={ball_8:{src:u,sprite:null},ball_16:{src:d,sprite:null},table:{src:y,sprite:null}},_=[],M=[{x:59,y:59,r:32},{x:59,y:531,r:32},{x:971,y:59,r:32},{x:971,y:531,r:32},{x:515,y:50,r:25},{x:515,y:540,r:25}],P=[[82,50,106,74],[106,74,475,74],[475,74,489,50],[540,50,554,74],[554,74,922,74],[922,74,946,50],[979,83,955,107],[955,107,955,482],[955,482,979,506],[946,539,922,515],[922,515,554,515],[554,515,540,539],[489,539,475,515],[475,515,106,515],[106,515,84,539],[50,506,74,482],[74,482,74,108],[74,108,50,84]];let E=Date.now();const I=()=>{{requestAnimationFrame(I);const t=Date.now(),e=t-E;E=t,(()=>{w.clearRect(0,0,f.width,f.height),w.drawImage(m.table.sprite,0,0,v,g),w.strokeStyle="#fff";for(const t of _)w.drawImage(m[t.spriteName].sprite,t.l,t.t,28,28);j.pressed&&new o(j.x1-j.x2,j.y1-j.y2).magnitude()>50&&(w.strokeStyle="#fff",w.beginPath(),w.moveTo(L.position.x,L.position.y),w.lineTo(L.position.x+(j.x1-j.x2),L.position.y+(j.y1-j.y2)),w.closePath(),w.stroke())})(),(t=>{t:for(let e=1;e<=10;e++)for(const n of _){const s=t/10*e/1e3;new o(n.position.x,n.position.y),n.position.add(o.scale(n.velocity,s));for(const{x:t,y:e,r:s}of M)if(o.distance(n.position,new o(t,e))<=s-8){n.destroy=!0;break t}const i=new o,r=[];for(const[t,e,s,a]of P)if(p(t,e,s,a,n.position.x,n.position.y,b)){r.push([t,e,s,a]);const n=new o(a-e,-(s-t)).normalize();i.add(n)}if(i.x||i.y){i.normalize();const t=2*o.dot(n.velocity,i),e=o.subtract(n.velocity,o.scale(i,t));for(n.velocity=e;r.some((([t,e,o,s])=>p(t,e,o,s,n.position.x,n.position.y,b)));)n.position.add(o.scale(n.velocity,.01))}for(const t of _)if(n!==t&&!n.collisionProcessed&&!t.collisionProcessed&&o.distance(n.position,t.position)<28){const[e,s,i,r]=A(n.position.x,n.position.y,n.velocity.x,n.velocity.y,t.position.x,t.position.y,t.velocity.x,t.velocity.y);for(n.velocity=new o(e,s),t.velocity=new o(i,r);o.distance(n.position,t.position)<28;)n.position.add(o.scale(n.velocity,.01)),t.position.add(o.scale(t.velocity,.01));n.collisionProcessed=!0,t.collisionProcessed=!0}n.velocity.add(n.acceleration),n.velocity.magnitude()<.001&&(n.velocity.x=0,n.velocity.y=0),n.acceleration=new o,n.acceleration.add(o.scale(n.velocity,-.001))}for(const t of _)t.collisionProcessed=!1,t.destroy&&_.splice(_.indexOf(t),1)})(e)}};let L;class q{destroy=!1;collisionProcessed=!1;constructor(t,e,n){this.position=new o(t,e),this.spriteName=n,this.velocity=new o,this.acceleration=new o}get l(){return this.position.x-b}get r(){return this.position.x+b}get t(){return this.position.y-b}get b(){return this.position.y+b}}Promise.all(Object.keys(m).map((t=>new Promise(((e,n)=>{const o=new Image;o.onload=()=>{m[t].sprite=o,e()},o.onerror=()=>{n()},o.src=m[t].src}))))).then((()=>{_.push(new q(708,295,"ball_8")),_.push(new q(736,281,"ball_8")),_.push(new q(736,309,"ball_8")),_.push(new q(764,295,"ball_8")),_.push(new q(764,267,"ball_8")),_.push(new q(764,323,"ball_8")),_.push(new q(792,281,"ball_8")),_.push(new q(792,253,"ball_8")),_.push(new q(792,337,"ball_8")),_.push(new q(792,309,"ball_8")),L=new q(294,295,"ball_16"),_.push(L),I()}));const A=(t,e,n,o,s,i,r,a,c=(s-=t)*s+(i-=e)*i,l=n*s+o*i-r*s-a*i)=>[n-(s*=l/c),o-(l*=i/c),r+s,a+l];let j={pressed:!1,x1:0,y1:0,x2:0,y2:0};document.addEventListener("mousedown",(t=>{j.pressed=!0,j.x1=t.pageX,j.y1=t.pageY,j.x2=t.pageX,j.y2=t.pageY})),document.addEventListener("touchstart",(t=>{j.pressed=!0,j.x1=t.touches[0].pageX,j.y1=t.touches[0].pageY,j.x2=t.touches[0].pageX,j.y2=t.touches[0].pageY})),document.addEventListener("mouseup",(()=>{j.pressed=!1;const t=new o(j.x1-j.x2,j.y1-j.y2);L.velocity=t})),document.addEventListener("touchend",(()=>{j.pressed=!1;const t=new o(j.x1-j.x2,j.y1-j.y2);t.magnitude()>50&&(L.velocity=t)})),document.addEventListener("mousemove",(t=>{j.x2=t.pageX,j.y2=t.pageY})),document.addEventListener("touchmove",(t=>{j.x2=t.touches[0].pageX,j.y2=t.touches[0].pageY}))}();
//# sourceMappingURL=index.c0395e55.js.map
